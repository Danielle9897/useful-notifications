@{
    ViewData["Title"] = "Upozornění na filmy s dobrým hodnocením v místním kině";
}

<div class="text-center">
    <h2>
        Upozornění na filmy s dobrým hodnocením v místním kině 
        (hodnocení filmu podle <a href="https://www.csfd.cz" target="_blank">ČSFD</a> nebo <a href="https://www.imdb.com" target="_blank">IMDb</a>)
    </h2>
</div>
<div class="text-left">
    <form method="post" asp-action="Subscribe">

        Země<br />
        <select name="country">
            <option value="czech_republic">Česká republika</option>
            <option value="slovakia">Slovensko</option>
            <option value="uk">United Kingdom</option>
        </select><br />
        <br />

        Hodnocení z<br />
        <select name="ratingSource">
            <option value="CSFD">ČSFD</option>
            <option value="IMDB">IMDB</option>
        </select><br />
        <br />

        <div id="townSection">
            Město<br />
            <input type="text" name="town" /><br />
            <br />
        </div>

        <div id="postCodeSection">
            Poštovní směrovací číslo<br />
            <input type="text" name="postcode" /><br />
            <br />
        </div>

        <div id="csfdRatingSection">
            Minimální hodnocení pro ČSFD (0 nejhorší, 100 nejlepší)<br />
            <input type="number" name="csfdMinimalRating" min="0" max="100" step="1" pattern="[0-9]*" value="80" />%<br />
            <br />
        </div>

        <div id="imdbRatingSection">
            Minimální hodnocení pro IMDB (0 nejhorší, 10 nejlepší)<br />
            <input type="number" name="imdbMinimalRating" min="0" max="10" step="0.1" pattern="[0-9]+([\.,][0-9]+)?" value="8.0" /><br />
            <br />
        </div>

        <input type="submit" value="Hledej filmy" /><br />
    </form>
</div>
@section Scripts {
    <script>
        var ratingSource = $("select[name='ratingSource']");

        initializeRatingSourceSelectionVisibility();
        initializeCountrySelectionVisibility();
        
        function initializeRatingSourceSelectionVisibility() {
            ratingSource.change(function() {
                var isCsfdRatingSelected = this.value === "CSFD";
                var csfdRatingSection = $("#csfdRatingSection");
                var imdbRatingSection = $("#imdbRatingSection");

                if (isCsfdRatingSelected)
                {
                    csfdRatingSection.show();
                    imdbRatingSection.hide();
                }
                else
                {
                    csfdRatingSection.hide();
                    imdbRatingSection.show();
                }
            }).change();
        }

        function initializeCountrySelectionVisibility() {
            $("select[name='country']").change(function() {
                var isCsfdCompatibleCountrySelected = this.value === "czech_republic" || this.value === "slovakia";
                var townSection = $("#townSection");
                var postCodeSection = $("#postCodeSection");

                var ratingSourceCsfdOption = ratingSource.find("option[value='CSFD']");

                if (isCsfdCompatibleCountrySelected) {
                    townSection.show();
                    postCodeSection.hide();

                    ratingSourceCsfdOption.show();
                    ratingSource.val("CSFD");
                    ratingSource.change();
                }
                else
                {
                    townSection.hide();
                    postCodeSection.show();

                    ratingSourceCsfdOption.hide();
                    ratingSource.val("IMDB");
                    ratingSource.change();
                }

            }).change();
        }
    </script>
}
